<html>


<script sec="/spy_professions.js"></script>
<script>

const g = (s) => {
 return document.getElementById(s);
}
const hiddenStyle ="visibility: hidden";
const visibleStyle ="visibility: unset";

function shuffle(array) {
  let currentIndex = array.length,  randomIndex;

  // While there remain elements to shuffle.
  while (currentIndex != 0) {

    // Pick a remaining element.
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;

    // And swap it with the current element.
    [array[currentIndex], array[randomIndex]] = [
      array[randomIndex], array[currentIndex]];
  }

  return array;
}

const numPlayers = 5;

let deck = [];

const items = professions;
const item = items[Math.floor(Math.random()*items.length)];

for (let i = 0; i < numPlayers - 1; ++i) {
  deck.push(item);
}
deck.push("SPY");
deck = shuffle(deck);


let current = 0;

const onShow = () => {
 g('label').innerText = 'Player ' + current + ' is ' + deck[current];
 g('hide').style = visibleStyle;
 g('show').style = hiddenStyle;
 current += 1;
};

const onHide = () => {
 if (current >= numPlayers) {
  g('label').innerText = 'Done';
  g('hide').style = hiddenStyle;
  g('show').style = hiddenStyle;
  return;
 }

 g('label').innerText = 'Hidden (pass to next player)';
 g('hide').style = hiddenStyle;
 g('show').style = visibleStyle;
};

window.onload = () => {
  g('hide').onclick = onHide;
  g('show').onclick = onShow;
  onHide();
};

</script>

<body>
<h2 id="label">Hidden</h2>

<button id="show">Show</button>
<button id="hide">Hide (done with turn)</button>

</body>
</html>
